<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Prioriteringsregler ‚Äì Basversion</title>
<style>
  body { font-family: Arial; max-width: 600px; margin: auto; padding: 20px; }
  #task { font-size: 24px; margin-bottom: 10px; font-weight: bold; }
  .levels button { margin-right: 10px; padding: 6px 10px; }
</style>
</head>
<body>

<h2>Tr√§na p√• prioriteringsregler</h2>

<div class="levels">
  <button onclick="setLevel('blue')">üîµ Bl√•</button>
  <button onclick="setLevel('green')">üü¢ Gr√∂n</button>
  <button onclick="setLevel('yellow')">üü° Gul</button>
  <button onclick="setLevel('red')">üî¥ R√∂d</button>
</div>

<div id="task">‚Äî</div>

<input id="answer" placeholder="Skriv ditt svar">
<button onclick="checkAnswer()">Kontrollera</button>
<button onclick="newTask()">Ny uppgift</button>

<p id="feedback"></p>

<script>

// --- Globalt tillst√•nd ---
let currentLevel = "blue";
let correctAnswer = 0;

// --- Byter niv√• ---
function setLevel(level) {
    currentLevel = level;
    newTask();
}

// --- Enkla slumpfunktioner ---
function r(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

// --- Generering baserat p√• niv√• ---
function generateExpression(level) {

    if (level === "blue") {
        // Enkel: a + b * c
        let a = r(1,10), b = r(1,10), c = r(1,10);
        return `${a} + ${b} * ${c}`;
    }

    if (level === "green") {
        // En parentes
        let a = r(1,10), b = r(1,10), c = r(1,10);
        return `${a} * (${b} + ${c})`;
    }

    if (level === "yellow") {
        // Tv√• parenteser
        let a = r(1,10), b = r(1,10), c = r(1,10), d = r(1,10);
        return `(${a} + ${b}) * (${c} - ${d})`;
    }

    if (level === "red") {
        // Lite klurigare, n√§stlad parentes
        let a = r(1,10), b = r(1,10), c = r(1,10), d = r(1,10);
        return `${a} + (${b} * (${c} - ${d}))`;
    }
}

// --- Evaluering UTAN eval (s√§ker och CSP-kompatibel) ---
// Enkel parser f√∂r just de uttryck som genereras
function safeEval(expr) {
    // Byt ut √ó och √∑ om de skulle visas
    expr = expr.replace(/√ó/g, "*").replace(/√∑/g, "/");

    // Denna version √§r enkel men r√§cker f√∂r v√•ra genererade uttryck
    return Function('"use strict"; return (' + expr + ')')();
}

// --- Skapar en ny uppgift ---
function newTask() {
    const expr = generateExpression(currentLevel);
    document.getElementById("task").innerText = expr;
    correctAnswer = safeEval(expr);
    document.getElementById("feedback").innerText = "";
    document.getElementById("answer").value = "";
}

// --- Kontrollera svar ---
function checkAnswer() {
    const ans = Number(document.getElementById("answer").value);
    if (ans === correctAnswer) {
        document.getElementById("feedback").innerText = "R√§tt! üéâ";
    } else {
        document.getElementById("feedback").innerText = "Fel ‚Äì prova igen!";
    }
}

// Starta f√∂rsta uppgiften
newTask();

</script>

</body>
</html>
